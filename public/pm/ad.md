# 广告页展示

## 需求

app 在启动后显示运营想要推广的广告页。

## app 上的规则

1. 第一次在当前设备上使用时有引导动画，这时不需要显示广告页；
2. 根据配置文件，约束广告页显示的内容，周期，停留时长和每日上限；
3. 当同一时期需要显示多个广告页时，每次需要显示时依次选择一个显示；
4. 后台静默下载 img 和 html 文件时需要校验配置文件里面的 md5 值，所有需要下载的资源都成功后下次启动时才会显示广告页；
5. 启动时以停留时长，产品代号,图片尺寸和图片类型为参数从本地请求加载网页，网页上根据请求的时长显示自动消失的倒计时，倒计时结束后 js 告诉 app 关闭浏览器；
6. 网页上也有用户可以点击跳过的按钮，用户点击后 js 告诉 app 关闭浏览器；

## 实现方案

### IM 服务端

app 登录时 IM 服务端下发 当前配置文件的版本号，地址和 md5 值；

### web 服务端

web 服务端提供配置文件，html 文件和 img 文件的下载服务；

### 客户端

1. 登录时根据 IM 服下发的广告的截止日期和配置文件的版本号选择是否显示广告及是否更新本地的配置文件；
2. 如果需要当前需要显示广告及需要更新配置文件，就去下载配置文件并解析；
3. 根据当前配置文件去更新本地 html 和 img 文件并校验文件完整性；
4. 如果本地文件完整，则在下次启动时显示广告页，并满足配置文件中的约束；

### 管理后台

1. 由运营维护，图片按照文件大小和游戏代号命名后上传；
2. 后台维护显示时长[1s-3s]，周期[1h-5h]，每日上限[3-6]，当前需要推广的产品代号['sw','mx'...]，广告截止日期 提交后更改配置文件；
3. 配置文件更改后，管理后台把配置文件升级后的版本号和 md5 值发给IM服；

## 后续优化

1. 统计点击率，转化率等相关数据；
2. 广告页上支持2次跳转；